<%- include("partials/head") %>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">

      <div class="card shadow-lg border-danger">
        <div class="card-header bg-danger text-white text-center py-3">
          <h3 class="mb-0">ğŸš¨ BÅ‚Ä…d 500 â€” WewnÄ™trzny bÅ‚Ä…d serwera</h3>
        </div>

        <div class="card-body">

          <p class="text-center">
            CoÅ› poszÅ‚o nie tak po stronie serwera.  
            JeÅ›li problem bÄ™dzie siÄ™ powtarzaÅ‚ â€” zgÅ‚oÅ› go poniÅ¼ej.
          </p>

          <div class="alert alert-secondary text-center">
            ğŸ“Œ <strong>Kod bÅ‚Ä™du:</strong> <%= errorId %>
          </div>

          <h5 class="mt-4">ZgÅ‚oÅ› problem</h5>
          <form id="feedbackForm" class="mt-3">
            <div class="mb-3">
              <textarea
                class="form-control"
                id="feedbackText"
                rows="4"
                placeholder="Opisz, co robiÅ‚eÅ› przed wystÄ…pieniem bÅ‚Ä™du..."
                required
              ></textarea>
            </div>

            <button class="btn btn-primary w-100" type="submit">
              WyÅ›lij zgÅ‚oszenie
            </button>
          </form>

          <p id="feedbackStatus" class="mt-3 text-success text-center"></p>

          <div class="text-center mt-4">
            <a href="/" class="btn btn-outline-secondary">
              â† PowrÃ³t do strony gÅ‚Ã³wnej
            </a>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>

<script>
document.getElementById("feedbackForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const msg = document.getElementById("feedbackText").value.trim();
  if (!msg) return;

  const resp = await fetch("/feedback", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      text: msg,
      page: window.location.pathname
    })
  });

  document.getElementById("feedbackStatus").textContent =
    "âœ”ï¸ DziÄ™kujemy! ZgÅ‚oszenie zostaÅ‚o wysÅ‚ane.";
});
</script>
